"use strict";(self.webpackChunk_unleashit_docs=self.webpackChunk_unleashit_docs||[]).push([[972],{6536:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>h,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var t=r(5723),s=r(1373),a=r(6196),d=r(7867),l=r(6810);const o={title:"Async Handler",description:"Async Handler"},c=void 0,i={id:"components/asyncHandler",title:"Async Handler",description:"Async Handler",source:"@site/docs/components/asyncHandler.mdx",sourceDirName:"components",slug:"/components/asyncHandler",permalink:"/npm-library/components/asyncHandler",draft:!1,unlisted:!1,editUrl:"https://github.com/unleashit/npm-library/tree/master/shared/docs/docs/components/asyncHandler.mdx",tags:[],version:"current",frontMatter:{title:"Async Handler",description:"Async Handler"},sidebar:"tutorialSidebar",previous:{title:"Components",permalink:"/npm-library/category/components"},next:{title:"Forgot Password",permalink:"/npm-library/components/forgotPassword"}},h={},p=[{value:"Demo",id:"demo",level:3},{value:"Install",id:"install",level:3},{value:"Example with render prop",id:"example-with-render-prop",level:3},{value:"HOC example using cache and optional components",id:"hoc-example-using-cache-and-optional-components",level:3},{value:"CSS",id:"css",level:3},...l.RM,{value:"API",id:"api",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"HOC that takes an async function and returns views for loading, no-data and error states. It accepts an optional method to check a cache before the async function is run."}),"\n",(0,t.jsx)(n.admonition,{title:"Deprecated",type:"warning",children:(0,t.jsx)(n.p,{children:"This package has been deprecated in favor of more complete solutions like React Query."})}),"\n",(0,t.jsx)(n.h3,{id:"demo",children:"Demo"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://npm-library-demo.vercel.app/async-handler",children:"https://npm-library-demo.vercel.app/async-handler"})}),"\n",(0,t.jsx)(n.h3,{id:"install",children:"Install"}),"\n",(0,t.jsxs)(a.A,{groupId:"npm2yarn",children:[(0,t.jsx)(d.A,{value:"npm",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm install @unleashit/async-handler\n"})})}),(0,t.jsx)(d.A,{value:"yarn",label:"Yarn",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"yarn add @unleashit/async-handler\n"})})}),(0,t.jsx)(d.A,{value:"pnpm",label:"pnpm",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pnpm add @unleashit/async-handler\n"})})})]}),"\n",(0,t.jsx)(n.p,{children:"Required peer dependencies: react."}),"\n",(0,t.jsx)(n.h3,{id:"example-with-render-prop",children:"Example with render prop"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"import React from 'react';\nimport AsyncHandler from '@unleashit/async-handler';\n\nclass ColorList extends React.Component {\n  request() {\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        resolve(['red', 'green', 'blue', 'yellow', 'orange', 'black', 'white']);\n      }, 1500);\n    });\n  }\n\n  render() {\n    return (\n      <AsyncHandler request={this.request}>\n        {(data) => <div>{data.join(', ')}</div>}\n      </AsyncHandler>\n    );\n  }\n}\n\nexport default ColorList;\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This will display default messages for loading, error or no results* as needed. Note that ",(0,t.jsx)(n.code,{children:"request"})," should return a promise with just the data part of the response so AsyncHandler can know when to display the no results component."]}),"\n",(0,t.jsx)(n.p,{children:"* no results meaning when an object with no keys or a zero length array is returned."}),"\n",(0,t.jsx)(n.h3,{id:"hoc-example-using-cache-and-optional-components",children:"HOC example using cache and optional components"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"import { withAsyncHandler } from '@unleashit/async-handler';\nimport MySpinner from './spinner';\n\n// data to fetch asynchronously, here for demo reasons\nconst users = [\n  {\n    id: 1,\n    name: 'joe',\n    age: 30,\n  },\n  {\n    id: 2,\n    name: 'judy',\n    age: 27,\n  },\n];\n\n// for demonstration, normally you might use\n// Redux or another decoupled place to store the cache.\nlet userCache = null;\n\nconst UserList = ({ data }) => {\n  return (\n    <ul>\n      {data.map((item) => (\n        <li key={item.id}>\n          {item.name} is {item.age} years old.\n        </li>\n      ))}\n    </ul>\n  );\n};\n\nexport default withAsyncHandler({\n  request: () => {\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        userCache = { users, cacheDate: new Date() };\n        resolve(users);\n      }, 1500);\n    });\n  },\n  cache: () => {\n    return userCache && new Date() - userCache.cacheDate <= 5 * 1000\n      ? userCache.users\n      : null;\n  },\n  loaderComponent: <MySpinner foo={'bar'} />,\n  noResultsComponent: <div>No user{\"'\"}s found.</div>,\n  errorComponent: ({ error }) => (\n    <div>Oops, there was a problem: {JSON.stringify(error)}</div>\n  ),\n})(UserList);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"css",children:"CSS"}),"\n",(0,t.jsx)(l.Ay,{name:o.title}),"\n",(0,t.jsx)(n.h3,{id:"api",children:"API"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface DefaultComponentProps {\n  cssModule?: {\n    [key: string]: string;\n  };\n  error?: any;\n}\ntype DefaultComponent = (props?: DefaultComponentProps) => React.ReactNode;\ninterface Props {\n  request: () => Promise<any>;\n  cache: () => object | any[] | false | null;\n  loaderComponent: DefaultComponent;\n  noResultsComponent: DefaultComponent;\n  errorComponent: DefaultComponent;\n  cssModule?: { [key: string]: string };\n  children: (data: any) => any;\n}\n"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Name"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"}),(0,t.jsx)(n.th,{children:"default"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"request"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"() => Promise<any>"})}),(0,t.jsx)(n.td,{children:"Called if cache function exists and doesn't return a falsy value"}),(0,t.jsx)(n.td,{children:"required"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cache"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"() => object | any[] | false | null"})}),(0,t.jsx)(n.td,{children:"Optional function that should return a cache object or null (calls the request)"}),(0,t.jsx)(n.td,{children:"n/a"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"noResultsComponent"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"() => React.ReactNode"})}),(0,t.jsx)(n.td,{children:"React component to override default no results message"}),(0,t.jsx)(n.td,{children:"Nothing found."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"errorComponent"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"({ error }: {error: any} ) => React.ReactNode"})}),(0,t.jsx)(n.td,{children:"React component to override default error message"}),(0,t.jsx)(n.td,{children:"default message with error displayed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"loaderComponent"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"() => React.ReactNode"})}),(0,t.jsx)(n.td,{children:"React component to override the default loader"}),(0,t.jsx)(n.td,{children:"Loading..."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cssModule"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"Recrord<string, string>"})}),(0,t.jsx)(n.td,{children:"CSS Module object that optionally replaces default. Class names need to match expected names."}),(0,t.jsx)(n.td,{children:"undefined"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"children"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"(data: any) => any"})}),(0,t.jsx)(n.td,{children:"Function to be called with data if request returns with results (AsyncHandler only)"}),(0,t.jsx)(n.td,{children:"n/a"})]})]})]})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}}}]);